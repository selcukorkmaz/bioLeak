% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/audit.R
\name{audit_leakage}
\alias{audit_leakage}
\title{Audit leakage and confounding}
\usage{
audit_leakage(
  fit,
  n_perm = 200,
  perm_stratify = TRUE,
  parallel = FALSE,
  seed = 1,
  batch_cols = NULL,
  coldata = NULL,
  X_ref = NULL,
  feature_space = c("raw", "rank"),
  sim_method = c("cosine", "pearson"),
  sim_threshold = 0.995,
  nn_k = 50,
  max_pairs = 5000
)
}
\arguments{
\item{fit}{LeakFit}

\item{n_perm}{integer, number of permutations for permutation test (default 200)}

\item{perm_stratify}{logical, stratify permutation by class within fold (binomial)}

\item{parallel}{logical, use future.apply for permutations}

\item{seed}{integer random seed}

\item{batch_cols}{character vector of metadata columns to test association with folds}

\item{coldata}{optional data.frame of sample-level metadata (rows align to original samples)}

\item{X_ref}{optional numeric matrix/data.frame (samples x features) used for duplicate detection}

\item{feature_space}{"raw" or "rank" (rank-normalize rows before similarity)}

\item{sim_method}{"cosine" or "pearson"}

\item{sim_threshold}{numeric in (0,1), similarity threshold for duplicates (default 0.995)}

\item{nn_k}{integer, if RANN available and n large, #nearest neighbors per row to check (default 50)}

\item{max_pairs}{cap on the number of duplicate pairs returned (default 5000)}
}
\value{
LeakAudit
}
\description{
Audit leakage and confounding
}
