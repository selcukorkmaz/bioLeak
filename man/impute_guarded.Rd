% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/impute_guarded.R
\name{impute_guarded}
\alias{impute_guarded}
\title{Leakage-safe data imputation (robust, enhanced version)}
\usage{
impute_guarded(
  train,
  test,
  method = c("median", "mean", "mode", "constant", "knn", "mice", "missForest"),
  constant_value = 0,
  k = 5,
  seed = 123,
  winsor = TRUE,
  winsor_thresh = 3,
  parallel = FALSE,
  return_outliers = FALSE,
  vars = NULL
)
}
\arguments{
\item{train}{data frame (training set)}

\item{test}{data frame (test set)}

\item{method}{one of "mean", "median", "mode", "constant", "knn", "mice", or "missForest"}

\item{constant_value}{numeric or character value if method = "constant"}

\item{k}{number of neighbors for kNN imputation (if method = "knn")}

\item{seed}{random seed for reproducibility}

\item{winsor}{logical; apply MAD-based Winsorization before imputation}

\item{winsor_thresh}{numeric; MAD cutoff (default = 3)}

\item{parallel}{logical; enable parallel imputation for heavy models (default = FALSE)}

\item{return_outliers}{logical; return logical matrix of Winsorized outlier flags}

\item{vars}{optional character vector; impute only selected variables}
}
\value{
A LeakImpute object with imputed data, model, and diagnostic summary.
}
\description{
Performs simple and advanced missing value imputation methods while preventing
information leakage. All imputation parameters are learned *only* from training data
and then applied to the test data. Includes Median Absolute Deviation (MAD)â€“based
Winsorization for robust outlier handling, automatic factor level preservation,
and diagnostic summaries.
For kNN and missForest, imputation is fit on the training set and then
train-derived fill values are applied to test rows to avoid leakage.
}
\examples{
train <- data.frame(x = c(1, 2, NA, 4), y = c(NA, 1, 1, 0))
test <- data.frame(x = c(NA, 5), y = c(1, NA))
imp <- impute_guarded(train, test, method = "median", winsor = FALSE)
imp$train
imp$test
}
\references{
Rousseeuw & Croux (1993), *Alternative to the Median Absolute Deviation.*
}
\seealso{
[VIM::kNN()], [mice::mice()], [missForest::missForest()]
}
